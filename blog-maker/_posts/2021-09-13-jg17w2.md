-----
title: 论软件架构风格
tags: [软考,系统架构设计师]
-----


【正文】
-------

本人所在公司接到了为客户开发BI系统的任务，该系统主要根据后台存储的数据生成图表展示页面，供客户方高管查看、并在客户方的大屏幕上展示，且客户方相关工作人员可以编辑图表展示页面的布局和页面中要显示的卡片。系统采用前后端分离架构，后端主要使用的技术有JAVA、SpringBoot、PostgreSQL，前端主要使用的技术有Vue.js、vuex、ECharts、Element-UI。

系统主要分为三部分：一、卡片模块：用来显示不同类型的图表，包括柱状图、条形图、散点图、杜邦图等，每一张卡片都对应了不同的数据源、数据类型、图表类型等内容。二、页面编辑模块：可以通过拖动的方式编辑图表展示页面的布局，然后再为布局中的每个格子配置待显示的卡片，最后再配置该页面对应的菜单项。三、页面展示模块：包括菜单和图表页面显示区，根据用户点击的菜单项，拉取对应的页面布局信息生成对应的页面，然后再拉取页面中的卡片数据并将卡片显示在页面的相应位置中。

本人主要负责领导前端团队进行开发工作，并设计BI系统的前端架构，以及与后端团队的沟通。

软件架构风格可分为以下几种：数据流风格；层次化风格；独立构件风格；解释器风格；规则系统风格；仓库风格。

数据流风格，过滤器风格：使用数据流风格时，所有构件通过接收来自输入源或上一个组件的数据流来进行相关的操作，然后根据输入的数据修改构件自己的状态、将输入数据处理成下一环节所需的数据、或进行其它操作，并将处理好的数据输出到下一个组件或数据接收端。整个处理过程中数据的流向是单向的，可用于处理海量数据的场景。

层次化风格：对应的做法通常是将系统自顶向下地分解成子系统、子构件、子模块，或自底向上地把子构件组合成大的构件，最后形成完整的系统。很多时候也需要将自顶向下地分解操作和或自底向上的组合操作结合使用。构件间的调用关系也具有层次性，一个构件通常只负责与上一层构件和下一层构件进行数据交换，修改一个构件通常只影响其上层构件和下层构件。

独立构件风格：所有构件均独立工作，构件间的数据交换可通过点对点的方式完成，也可通过事件广播的方式完成。点对点的方式通常可通过RPC、消息队列等方式进行，是一个命名过程。事件广播方式为非命名过程，一个构件发出一个事件，其它构件只需注册了该事件的监听器即可处理该事件。

解释器风格：根据输入的指令更改构件自身的状态或进行其它操作，指令系统可自行设计；常用场景如JAVA虚拟机或硬件模拟器。

规则系统风格：构件可根据已编写好的规则进行相应的操作，相应规则可直接作为代码实现，性能好但灵活性差。也可以从数据库/缓存中加载相应的规则（比如算术表达式），灵活性好但性能较低。

仓库风格：包含数据库架构风格和黑板架构风格。可以实现成多个构件共享相同的系统状态，或者构件只维护其自身的状态。

经过需求分析过程，本人发现卡片模块中各个卡片间一般都是独立工作的，只有小部分情况下会出现需要联动操作的情况。因此本人决定使用独立构件风格进行架构设计，在需要进行联动操作的卡片间使用事件总线进行数据交换，并使用事件驱动方式实现联动操作。为了加快开发和测试进度，充分利用团队中的人力，本人决定让团队中每个人各自负责相应类型的卡片开发任务，并在开发完成后立刻通知测试人员进行测试。

对于页面展示模块，本人则以层次化风格为主，结合使用独立构件风格的方式进行架构设计，先将该模块分解成菜单管理器和报表展示区两个构件，再将报表展示区分解成布局管理器和图表卡片展示模块，一个报表展示区对应多个布局管理器模块，一个布局管理器模块对应多个卡片模块。菜单管理器和报表展示区间的通信使用事件驱动的方式进行处理，当用户点击菜单时，菜单管理器发出菜单更改事件，报表展示区接收到菜单更改事件后加载新数据并刷新页面。
