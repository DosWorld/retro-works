DEFDBL A-Z:DEFINT C,I,J
DECLARE SUB QSORT(A() AS DOUBLE, L AS INTEGER, R AS INTEGER)

S=0:C=0:DIM D(1024)
INPUT "Filename: ",F$
OPEN F$ FOR INPUT AS #1
WHILE NOT EOF(1)
  INPUT #1,D(C)
  V=D(C):S=S+V:C=C+1
  IF C=1 THEN
    MIN=V:MAX=V
  ELSEIF V<MIN THEN
    MIN=V
  ELSEIF V>MAX THEN
    MAX=V
  END IF
WEND
CLOSE #1
PRINT "Count:   ";C
PRINT "Sum:     ";S
PRINT "Average: ";S/C
PRINT "Min:     ";MIN
PRINT "Max:     ";MAX
A=S/C:VAR=0
FOR I=0 TO C-1:VAR=VAR+(D(I)-A)^2:NEXT I
PRINT "STDDEV:  ";SQR(VAR/C)
PRINT "STDDEV2: ";SQR(VAR/(C-1))
CALL QSORT(D(), 0, C-1)
PRINT "Middle:  ";
IF C AND 1 THEN PRINT D(C\2) ELSE PRINT D(C\2-1);D(C\2)
END

SUB QSORT(A() AS DOUBLE, L AS INTEGER, R AS INTEGER)
  IF L >= R THEN EXIT SUB
  
  REM CHECK IF SEQ IS SORTED
  SORTED = 1
  FOR I = L TO R-1
    IF A(I) > A(I+1) THEN
      SORTED = 0
      EXIT FOR
    END IF
  NEXT I
  IF SORTED = 1 THEN EXIT SUB
  
  REM QUICK SORT MAIN
  I = L : J = R : K# = A(L)
  WHILE I < J
    WHILE I < J AND K# <= A(J)
      J = J - 1
    WEND
    A(I) = A(J)
    WHILE I < J AND K# >= A(I)
      I = I + 1
    WEND
    A(J) = A(I)
  WEND
  A(I) = K#
  
  REM QSORT FOR SUBGROUPS
  CALL QSORT(A(), L, I-1)
  CALL QSORT(A(), I+1, R)
END SUB
