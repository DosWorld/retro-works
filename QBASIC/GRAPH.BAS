DEFINT A-Z
L=0:LT=0:S#=0:M#=0:Y=1

' INPUT "Filename: ", F$
F$="gdata2.txt"
OPEN F$ FOR INPUT AS #1
WHILE NOT EOF(1)
  INPUT #1,T$,D#: L=L+1
  S#=S#+D#: IF D#>M# THEN M#=D#
  K=LEN(T$): IF K>LT THEN LT=K
WEND
CLOSE #1

SCREEN 12
WIDTH 80,60
COLOR 15
CLS:DIM G(2048)
LT=LT*8:W=638-LT

OPEN F$ FOR INPUT AS #1
FOR I=1 TO L
  INPUT #1,T$,D#

  LOCATE 60,1,0:PRINT T$;TAB(39);
  GET (0,472)-(LT,479),G:PUT (0,Y-1),G,PSET

  K!=D#/M#:LINE (LT+1,Y-1)-(K!*W+LT+1,Y+7),,BF

  LOCATE 60,1,0
  SV$ = LTRIM$(RTRIM$(STR$(D#)))
  PRINT SV$;"(";: PRINT USING "##.###%";D#/S#*100;: PRINT ")";
  GET (0,472)-(70+LEN(SV$)*8,479),G
  IF K!>0.5 THEN
    PUT (K!*W+LT-70-LEN(SV$)*8,Y-1),G,PRESET
  ELSE
    PUT (K!*W+LT+4,Y-1),G,PSET
  END IF
  IF (I MOD 47)<>0 THEN
    Y=Y+10
  ELSE
    LOCATE 60,1,0:PRINT "Press any key to continue";TAB(39);
    WHILE INPUT$(1)="":WEND:CLS:Y=1
  END IF
NEXT I
CLOSE #1
LOCATE 60,1,0:PRINT TAB(39);
WHILE INPUT$(1)="":WEND:CLS:SCREEN 0:END
