10 DEFINT A-Z:KEY OFF
20 L=0:LT=0:S#=0:M#=0:Y=1:DIM LABEL$(2048),VALUE#(2048)
30 INPUT "Filename: ",F$:OPEN F$ FOR INPUT AS #1
40 WHILE NOT EOF(1):INPUT #1,T$,D#:L=L+1
50 S#=S#+D#:IF D#>M# THEN M#=D#
60 K=LEN(T$)+9:IF K>LT THEN LT=K
62 LABEL$(L)=T$:VALUE#(L)=D#
70 WEND:CLOSE #1
80 SCREEN 2:CLS:W=638-LT*8:FOR I=1 TO L
82 D#=VALUE#(I)
90 LOCATE Y,1,0:PRINT LABEL$(I);
100 LOCATE Y,LT-8:PRINT "(";:PRINT USING "##.###%";D#/S#*100;:PRINT ")";
110 K!=D#/M#:LINE (LT*8+1,(Y-1)*8)-(K!*W+LT*8+1,(Y-1)*8+6),,BF
120 IF Y<24 THEN Y=Y+1:GOTO 150
130 LOCATE 25,1,0:PRINT "Press any key to continue";
140 WHILE INPUT$(1)="":WEND:CLS:Y=1
150 NEXT I
160 WHILE INPUT$(1)="":WEND:CLS:SCREEN 0:END
