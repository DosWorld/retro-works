10 DEFINT A-Z:KEY OFF
20 L=0:LT=0:S#=0:M#=0:Y=1:DIM LABEL$(2048),VALUE#(2048)
30 INPUT "Filename: ",F$:OPEN F$ FOR INPUT AS #1
40 WHILE NOT EOF(1):INPUT #1,T$,D#:L=L+1
50 S#=S#+D#:IF D#>M# THEN M#=D#
60 K=LEN(T$)+9:IF K>LT THEN LT=K
62 LABEL$(L)=T$:VALUE#(L)=D#
70 WEND:CLOSE #1
80 SCREEN 2:CLS:W=638-LT*8
82 FOR I=1 TO L:D#=VALUE#(I)
90 LOCATE Y,1,0:PRINT LABEL$(I);
100 LOCATE Y,LT-8:PRINT "(";:PRINT USING "##.###%";D#/S#*100;:PRINT ")";
110 K!=D#/M#:LINE (LT*8+1,(Y-1)*8)-(K!*W+LT*8+1,(Y-1)*8+6),,BF
120 IF Y<24 THEN Y=Y+1:GOTO 150
130 LOCATE 25,1,0:PRINT "Press any key to continue";
140 WHILE INPUT$(1)="":WEND:CLS:Y=1
150 NEXT I:WHILE INPUT$(1)="":WEND:CLS
160 IF L>25 OR L<2 THEN SCREEN 0:END
170 DIM PAT$(16):GOSUB 400
180 PI#=3.141592654:PI2#=PI#*2:Y=(25-L)/2:K1#=0:K2#=VALUE#(1)
200 FOR I=1 TO L:LOCATE Y+1,3,0:PRINT LABEL$(I):D#=VALUE#(I)
201 LINE (0,Y*8)-(14,Y*8+6),1,B:COL=(I-2) MOD 14
202 LOCATE Y+1,LT-8+2:PRINT "(";:PRINT USING "##.###%";D#/S#*100;:PRINT ")";
210 IF I>1 THEN PAINT(3,Y*8+3),PAT$(COL)
220 AS#=K1#/S#*PI2#:IF I=L THEN AE#=PI2# ELSE AE#=K2#/S#*PI2#
230 IF ABS(AS#)<0.00001 THEN AS#=0.00001
240 CIRCLE (430,100),170,1,-AS#,-AE#,0.5
250 XP=430+(140)*COS((AS#+AE#)/2):YP=100-(70)*SIN((AS#+AE#)/2)
260 IF I>1 THEN PAINT(XP,YP),PAT$(COL)
270 K1#=K1#+VALUE#(I):K2#=K2#+VALUE#(I+1)
280 Y=Y+1:NEXT I:WHILE INPUT$(1)="":WEND
300 CLS:SCREEN 0:END
400 PAT$(0)=CHR$(255):PAT$(1)=CHR$(170)+CHR$(85)
401 PAT$(2)=CHR$(255)+CHR$(170):PAT$(3)=CHR$(0)+CHR$(170)
402 PAT$(4)=CHR$(136)+CHR$(68)+CHR$(34)+CHR$(17)
403 PAT$(5)=CHR$(17)+CHR$(34)+CHR$(68)+CHR$(136)
404 FOR I=0 TO 7:READ CH:PAT$(6)=PAT$(6)+CHR$(CH):NEXT I
405 DATA &H81,&H42,&H24,&H18,&H18,&H24,&H42,&H81
406 PAT$(7)=CHR$(136)+CHR$(68)+CHR$(34)+CHR$(17)+CHR$(34)+CHR$(68)
407 PAT$(8)=CHR$(68)+CHR$(68)+CHR$(255)
408 PAT$(9)=CHR$(119)+CHR$(187)+CHR$(221)+CHR$(238)
409 PAT$(10)=CHR$(238)+CHR$(221)+CHR$(187)+CHR$(119)
410 FOR I=0 TO 7:READ CH:PAT$(11)=PAT$(11)+CHR$(CH):NEXT I
411 DATA 126,189,219,231,231,219,189,126
412 PAT$(12)=CHR$(119)+CHR$(187)+CHR$(221)+CHR$(238)+CHR$(221)+CHR$(187)
413 PAT$(13)=CHR$(187)+CHR$(187)+CHR$(0)
414 RETURN
