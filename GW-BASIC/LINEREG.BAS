10 DEFDBL A-Z:DEFINT I:L%=0
12 ON ERROR GOTO 20
14 WHILE 1:READ X,Y:L%=L%+1:WEND
20 IF ERR<>4 THEN ON ERROR GOTO 0
22 IF L%<2 THEN END
24 T0=0:T1=0:J0=1:J1=1:L=L%
30 WHILE ABS(J0)>0.0001 OR ABS(J1)>0.0001
32 A=1:B=0:D=0:J0=0:J1=0
40 RESTORE:FOR I=1 TO L:READ X,Y
42 B=B+X:D=D+X*X:H=T0+T1*X
44 J0=J0+(H-Y):J1=J1+(H-Y)*X
46 NEXT I
48 B=B/L:C=B:D=D/L:J0=J0/L:J1=J1/L
50 DET=1/(A*D-B*C)
52 A1=DET*D:B1=DET*(-B):C1=DET*(-C):D1=DET*A
54 T0=T0-(A1*J0+B1*J1):T1=T1-(C1*J0+D1*J1)
60 WEND
70 PRINT "y=A+Bx":PRINT "A=";T0:PRINT "B=";T1
90 END
